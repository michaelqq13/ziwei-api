# 流年流月流日功能說明

## 功能概述

新增了流年、流月、流日三個按鈕，點擊後會在命盤圖上顯示對應的流運命宮位置。

## 功能特點

### 1. 流年功能
- **按鈕名稱**: 流年
- **功能**: 顯示流年命宮位置
- **計算基準**: 使用排盤時間的年份
- **視覺效果**: 
  - 流年命宮有青色邊框和陰影
  - 宮位名稱顯示為"流年命宮"、"流年兄弟"等
  - 右上角顯示"流年"標記

### 2. 流月功能
- **按鈕名稱**: 流月
- **功能**: 顯示流月命宮位置
- **計算基準**: 使用排盤時間的年份和月份
- **視覺效果**: 
  - 流月命宮有青色邊框和陰影
  - 宮位名稱顯示為"流月命宮"、"流月兄弟"等
  - 右上角顯示"流月"標記

### 3. 流日功能
- **按鈕名稱**: 流日
- **功能**: 顯示流日命宮位置
- **計算基準**: 使用排盤時間的年份、月份和日期
- **視覺效果**: 
  - 流日命宮有青色邊框和陰影
  - 宮位名稱顯示為"流日命宮"、"流日兄弟"等
  - 右上角顯示"流日"標記

## 使用方法

1. **啟動流運模式**: 點擊對應的流年/流月/流日按鈕
2. **查看流運命宮**: 命盤會顯示對應的流運命宮位置（青色邊框）
3. **切換回本命盤**: 再次點擊已激活的按鈕，或點擊其他流運按鈕
4. **狀態指示**: 界面右上角會顯示當前模式（如"流年模式"）

## 按鈕狀態

- **未激活**: 灰色背景，顯示"流年"/"流月"/"流日"
- **激活中**: 彩色背景（藍色/綠色/紫色），顯示"本命盤"
- **載入中**: 顯示"載入中..."，按鈕禁用

## 技術實現

### 後端API
- `/chart/annual-fortune`: 獲取流年資料
- `/chart/monthly-fortune`: 獲取流月資料  
- `/chart/daily-fortune`: 獲取流日資料

### 前端狀態管理
- `fortuneMode`: 當前流運模式 ('natal' | 'annual' | 'monthly' | 'daily')
- `annualFortune`: 流年資料
- `monthlyFortune`: 流月資料
- `dailyFortune`: 流日資料

### 視覺標記
- **流運命宮**: 青色邊框 (`border-cyan-400`)
- **太極點**: 黃色邊框 (`border-yellow-400`)
- **流運標記**: 宮位名稱旁顯示對應的流運類型

## 注意事項

1. **互斥性**: 同時只能啟動一種流運模式
2. **重置機制**: 切換流運模式時會自動重置太極點轉換
3. **錯誤處理**: API調用失敗時會在控制台顯示錯誤信息
4. **載入狀態**: 請求期間按鈕會顯示載入狀態並禁用

## 未來擴展

- 支援自定義流運時間（年月日選擇器）
- 顯示流運宮位的詳細資訊
- 流運與太極點的組合分析
- 流運歷史記錄功能 